<!DOCTYPE html>
<html lang="en">

<head>
    <title>three.js webgl - postprocessing - unreal bloom selective</title>

</head>

<body>



    <script type="module">
        import * as THREE from "http://cs.merrimack.edu/~stuetzlec/three.js-master/build/three.module.js";
        import { PointerLockControls } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/controls/PointerLockControls.js';
        import { LightningStrike } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/geometries/LightningStrike.js';
        import { LightningStorm } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/objects/LightningStorm.js';


        //Variable Declaration
        import { OutlinePass } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/postprocessing/OutlinePass.js'
        import { RenderPass } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/postprocessing/RenderPass.js'
        import { EffectComposer } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/postprocessing/EffectComposer.js'
        import { ShaderPass } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/postprocessing/ShaderPass.js';
        import { UnrealBloomPass } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/postprocessing/UnrealBloomPass.js';
        import { OrbitControls } from 'http://cs.merrimack.edu/~stuetzlec/three.js-master/examples/jsm/controls/OrbitControls.js';
        // import {GUI} from ''

        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 10000);
        camera.position.set(-5, 5, 5);
        camera.layers.enable(1);
        var renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x101000);
        document.body.appendChild(renderer.domElement);

        var controls = new OrbitControls(camera, renderer.domElement);

        // var light = new THREE.DirectionalLight(0xffffff, 0.75);
        // light.position.setScalar(100);
        // scene.add(light);
        // scene.add(new THREE.AmbientLight(0xffffff, 0.25));

        var obj = new THREE.Mesh(new THREE.BoxGeometry(5, 5, 4), new THREE.MeshLambertMaterial({ 
            color: "yellow", wireframe: false }));
        obj.position.z = 0.25;
        scene.add(obj);

        var objBack = new THREE.Mesh(new THREE.BoxGeometry(5, 5, 1), new THREE.MeshBasicMaterial({ 
            color: "red", wireframe: false }));
        objBack.position.z = -2.25;
        objBack.layers.enable(1);
        scene.add(objBack);

        var objSepare = new THREE.Mesh(new THREE.BoxGeometry(5, 5, 1), 
        new THREE.MeshBasicMaterial({ color: "yellow", wireframe: false }));
        
        objSepare.position.set(1,1,5);
        objSepare.layers.enable(1);
        scene.add(objSepare);

        /** COMPOSER */
        let renderScene = new RenderPass(scene, camera)

        let bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85)
        bloomPass.threshold = 0.21
        bloomPass.strength = 1.2
        bloomPass.radius = 0.55
        bloomPass.renderToScreen = true

        let composer = new EffectComposer(renderer)
        composer.setSize(window.innerWidth, window.innerHeight)

        composer.addPass(renderScene)
        composer.addPass(bloomPass)

        renderer.gammaInput = true
        renderer.gammaOutput = true
        renderer.toneMappingExposure = Math.pow(0.9, 4.0)

        render();
        function render() {
            requestAnimationFrame(render);

            renderer.autoClear = false;
            renderer.clear();

            camera.layers.set(1);
            composer.render();

            renderer.clearDepth();
            camera.layers.set(0);
            renderer.render(scene, camera);
        }


    </script>

</body>

</html>